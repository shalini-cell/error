 %5_bit_Approximate multiplier_array  
function [prod] = array_8_rcpfa_7(input1,input2)
    
     %A=zeros(1,16);
     %B=zeros(1,16);
     A=de2bi(abs(input1),8);
     B=de2bi(abs(input2),8);
    %% Sign Bit
    % if input1<0
     %     A(1,16)=1;
     %end
    % if input2<0 
    %      B(1,16)=1;
    % end
      %% Partial products   
      P=zeros(8,8);
      
      for i=1:8
          for j=1:8
              %disp(B(1,i));
              %disp(A(1,j));
              P(i,j)=B(1,i)&A(1,j);
              %disp(P(i,j));
          end
      end
    %disp(P);
      
      S=zeros(16,16);
      C=zeros(16,16);
      FINAL=zeros(1,16);
    %  FINAL(1,31)=xor(B(1,16),A(1,16));
      FINAL(1,1)=P(1,1);
      [S(1,2),C(1,2)]=HA(P(1,2),P(2,1));
      f7=~(P(1,8)&P(2,7));
      f6=~(P(1,7)&P(2,6));
      f5=~(P(1,6)&P(2,5));
      f4=~(P(1,5)&P(2,4));
      f3=~(P(1,4)&P(2,3));
      f2=~(P(1,3)&P(2,2));
      f1=~(P(1,2)&P(2,1));
     C(1,8)=f7;
      [S(1,8),C(1,7)]=RA(P(1,8),P(2,7),C(1,8),f6);
      [S(1,7),C(1,6)]=RA(P(1,7),P(2,6),C(1,7),f5);
      [S(1,6),C(1,5)]=RA(P(1,6),P(2,5),C(1,6),f4);
      [S(1,5),C(1,4)]=RA(P(1,5),P(2,4),C(1,5),f3);
       [S(1,4),C(1,3)]=RA(P(1,4),P(2,3),C(1,4),f2); 
       [S(1,3),C(1,2)]=RA(P(1,3),P(2,2),C(1,3),f1);
       
      [S(1,9),C(1,9)]=HA(P(2,8),C(1,8));
      % disp(S(1,i));  end disp(C(1,17));
      %%
     
      FINAL(1,2)=S(1,2);
      [S(2,3),C(2,3)]=HA(S(1,3),P(3,1));
      f6=~(S(1,8)&P(3,6));
      f5=~(S(1,7)&P(3,5));
      f4=~(S(1,6)&P(3,4));
      f3=~(S(1,5)&P(3,3));
      f2=~(S(1,4)&P(3,2));
      f1=~(S(1,3)&P(3,1));
      C(2,8)=f6;
      [S(2,8),C(2,7)]=RA(S(1,8),P(3,6),C(2,8),f5);
      [S(2,7),C(2,6)]=RA(S(1,7),P(3,5),C(2,7),f4);
      [S(2,6),C(2,5)]=RA(S(1,6),P(3,4),C(2,6),f3);
      [S(2,5),C(2,4)]=RA(S(1,5),P(3,3),C(2,5),f2);
      [S(2,4),C(2,3)]=RA(S(1,4),P(3,2),C(2,4),f1);
      
      [S(2,9),C(2,9)]=FA(S(1,9),P(3,7),C(2,8));
      [S(2,10),C(2,10)]=FA(P(3,8),C(2,9),C(1,9));
      
      %%
      
      FINAL(1,3)=S(2,3);
      %for i=3:18 
       %disp(S(2,i));  end 
   %disp(C(2,18));
   
      [S(3,4),C(3,4)]=HA(S(2,4),P(4,1));
      f5=~(S(2,8)&P(4,5));
      f4=~(S(2,7)&P(4,4));
      f3=~(S(2,6)&P(4,3));
      f2=~(S(2,5)&P(4,2));
      f1=~(S(2,4)&P(4,1));
      C(3,8)=f5;
      [S(3,8),C(3,7)]=RA(S(2,8),P(4,5),C(3,8),f4);
      [S(3,7),C(3,6)]=RA(S(2,7),P(4,4),C(3,7),f3);
      [S(3,6),C(3,5)]=RA(S(2,6),P(4,3),C(3,6),f2);
      [S(3,5),C(3,4)]=RA(S(2,5),P(4,2),C(3,5),f1);
      
     
     
      [S(3,9),C(3,9)]=FA(S(2,9),P(4,6),C(3,8));
      [S(3,10),C(3,10)]=FA(S(2,10),P(4,7),C(3,9));
      [S(3,11),C(3,11)]=FA(P(4,8),C(3,10),C(2,10));
     
    %%
    
        FINAL(1,4)=S(3,4);
        
        
      [S(4,5),C(4,5)]=HA(S(3,5),P(5,1));
      %for i=1:13
       %   [S(4,i+5),C(4,i+5)]=FA(S(3,i+5),P(5,i+1),C(4,i+4));
       %end
       f4=~(S(3,8)&P(5,4));
       f3=~(S(3,7)&P(5,3));
       f2=~(S(3,6)&P(5,2));
       f1=~(S(3,5)&P(5,1));
      C(4,8)=f4;
      [S(4,8),C(4,7)]=RA(S(3,8),P(5,4),C(4,8),f3);
      [S(4,7),C(4,6)]=RA(S(3,7),P(5,3),C(4,7),f2);
     [S(4,6),C(4,5)]=RA(S(3,6),P(5,2),C(4,6),f1);
     
     
     [S(4,9),C(4,9)]=FA(S(3,9),P(5,5),C(4,8));
     [S(4,10),C(4,10)]=FA(S(3,10),P(5,6),C(4,9));
     [S(4,11),C(4,11)]=FA(S(3,11),P(5,7),C(4,10));
     [S(4,12),C(4,12)]=FA(P(5,8),C(4,11),C(3,11));
     
     
      FINAL(1,5)=S(4,5);
      
        
     [S(5,6),C(5,6)]=HA(S(4,6),P(6,1));
     f1=~(S(4,6)&P(6,1));
     f2=~(S(4,7)&P(6,2));
     f3=~(S(4,8)&P(6,3));
     C(5,8)=f3;
     [S(5,8),C(5,7)]=RA(S(4,8),P(6,3),C(5,8),f2);
     [S(5,7),C(5,6)]=RA(S(4,7),P(6,2),C(5,7),f1);
    
     [S(5,9),C(5,9)]=FA(S(4,9),P(6,4),C(5,8));
     [S(5,10),C(5,10)]=FA(S(4,10),P(6,5),C(5,9));
     [S(5,11),C(5,11)]=FA(S(4,11),P(6,6),C(5,10));
     [S(5,12),C(5,12)]=FA(S(4,12),P(6,7),C(5,11));
     [S(5,13),C(5,13)]=FA(P(6,8),C(5,12),C(4,12));
     
     %%
      FINAL(1,6)=S(5,6);
     
        
     [S(6,7),C(6,7)]=HA(S(5,7),P(7,1));
     f1=~(S(5,7)&P(7,1));
     f2=~(S(5,8)&P(7,2));
     C(6,8)=f2;
     [S(6,8),C(6,7)]=RA(S(5,8),P(7,2),C(6,8),f1);
     [S(6,9),C(6,9)]=FA(S(5,9),P(7,3),C(6,8));
     [S(6,10),C(6,10)]=FA(S(5,10),P(7,4),C(6,9));
     [S(6,11),C(6,11)]=FA(S(5,11),P(7,5),C(6,10));
     [S(6,12),C(6,12)]=FA(S(5,12),P(7,6),C(6,11));
     [S(6,13),C(6,13)]=FA(S(5,13),P(7,7),C(6,12));
     [S(6,14),C(6,14)]=FA(P(7,8),C(6,13),C(5,13));
     %%
      FINAL(1,7)=S(6,7);
     
     [S(7,8),C(7,8)]=HA(S(6,8),P(8,1)); 
     [S(7,9),C(7,9)]=FA(S(6,9),P(8,2),C(7,8));
     [S(7,10),C(7,10)]=FA(S(6,10),P(8,3),C(7,9));
     [S(7,11),C(7,11)]=FA(S(6,11),P(8,4),C(7,10));
     [S(7,12),C(7,12)]=FA(S(6,12),P(8,5),C(7,11));
     [S(7,13),C(7,13)]=FA(S(6,13),P(8,6),C(7,12));
     [S(7,14),C(7,14)]=FA(S(6,14),P(8,7),C(7,13));
     [S(7,15),C(7,15)]=FA(P(8,8),C(7,14),C(6,14));
     %%
     
     FINAL(1,8)=S(7,8);
      for i=8:1:15
          FINAL(1,i)=S(7,i);
      end
      FINAL(1,16)=C(7,15);
      %disp(FINAL);
      
     prod=bi2de(FINAL);
     if input1<0 & input2>0 || input1>0 & input2 <0
         prod=-prod;
     end
     
end